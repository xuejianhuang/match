
<script type="text/javascript">
	$(function() {
		$('#dg_groupMemberList')
				.datagrid(
						{
							view : detailview,
							detailFormatter : function(index, row) {
								return '<div style="padding:2px"><table id="dg_groupMemberList_ddv-' + index + '"></table></div>';
							},
							onExpandRow : function(index, row) {
								$('#dg_groupMemberList_ddv-' + index)
										.datagrid(
												{

													url : '/matchPlatform/public/searchMatchGroupMember?matchGroupCode='
															+ row.matchGroupCode
															+ '&matchProjectCode='
															+ row.matchProjectCode
															+ '&_'
															+ new Date()
																	.getTime(),
													 method: 'POST',
													fitColumns : true,
													remoteSort : false,
													rownumbers : true,
													columns : [ [
															{
																field : 'caption',
																align : 'center',
																sortable : 'true',
																title : '姓名',
																width : 30,
																formatter : function(
																		value,
																		row) {
																	return row.matchMember.caption;
																}
															},

															{
																field : 'isLeader',
																align : 'center',
																sortable : 'true',
																title : '职务',
																width : 10,
																formatter : function(
																		value,
																		row) {
																	if (row.isLeader == true)

																	{
																		return '队长';
																	} else {
																		return '组员';
																	}
																}
															},

															{
																field : 'phone',
																align : 'center',
																sortable : 'true',
																title : '手机号',
																width : 30,
																formatter : function(
																		value,
																		row) {
																	return row.matchMember.phone;
																}
															},

															{
																field : 'QQ',
																align : 'center',
																sortable : 'true',
																title : 'QQ',
																width : 30,
																formatter : function(
																		value,
																		row) {
																	return row.matchMember.qq;
																}
															}
															/*  , {
															field : 'package_',
															title : '游览类型',
															align:'center',
															width : 20
															}*/
															,
															{
																field : 'email',
																title : 'email',
																sortable : 'true',
																align : 'center',
																formatter : formatOper,
																width : 30,
																formatter : function(
																		value,
																		row) {
																	return row.matchMember.email;
																}
															} ] ],
													onResize : function() {
														$('#dg_groupMemberList')
																.datagrid(
																		'fixDetailRowHeight',
																		index);
													},
													onLoadSuccess : function() {
														setTimeout(
																function() {
																	$(
																			'#dg_groupMemberList')
																			.datagrid(
																					'fixDetailRowHeight',
																					index);
																}, 0);
													}
												});
								$('#dg_groupMemberList').datagrid(
										'fixDetailRowHeight', index);
							}
						});
		/* $('#dg_groupMemberList').datagrid({
			url : '/matchPlatform/public/searchMatchGroup',
			queryParams : {
				matchProjectId : groupMemberMathProjectId
			}
		}); */

	});
	groupMemberListsearch = function(periodType) {
		
		/* $('#dg_groupMemberList').datagrid('load', {
			caption : $('#groupMemberList_memeberName').val(),
			matchProjectId:groupMemberMathProjectId
		}); */

		 $('#dg_groupMemberList').datagrid({
			url : '/matchPlatform/public/searchMatchGroupMemberByCaption',
			 method: 'POST',
			queryParams : {
				caption : $('#groupMemberList_memeberName').val(),
				matchProjectId:groupMemberMathProjectId
			}
		}); 
	};
	function formatterTeacher(val, row, index) {
		return row.teacher.name;
	}
	function formatterStatus(val, row, index) {
		var innerHtml = '';
		if (val == false) {
			innerHtml += ' &nbsp; &nbsp;&nbsp;<a href="#" style="color: red;" onclick="frozen('
					+ row.id + ')">冻结</a>';

		} else {
			innerHtml += ' &nbsp; &nbsp;&nbsp;<a href="#"  onclick="unfrozen('
					+ row.id + ')">解冻</a>';
		}
		//	alert(row.itid);
		return innerHtml;
	}
	function frozen(matchProjectGroupId) {
		
		 ajaxSend('/matchPlatform/public/lockMatchGroup',{id:matchProjectGroupId},function()
				{
			$('#dg_groupMemberList' )
			.datagrid(
					"reload");
			
				}); 
	}
	function unfrozen(matchProjectGroupId) {
		 ajaxSend('/matchPlatform/public/unLockMatchGroup',{id:matchProjectGroupId},function()
					{
			 $('#dg_groupMemberList' )
				.datagrid(
						"reload");
				
					}); 

	}
</script>

<div style="margin:1px 0;"></div>
<table id="dg_groupMemberList" class="easyui-datagrid" style=""
	data-options="
        fitColumns:true,
        collapsible:true,
		method:'get',
		url : '/matchPlatform/public/searchMatchGroup?matchProjectId='+groupMemberMathProjectId,
		   remoteSort:false,
		     pagination : true,
			 pageSize : 10,
			 pageList : [ 10, 20, 30, 40, 50 ],
		  toolbar:'#dg_groupMemberList_tb'
		 ">
	<thead>
		<tr>
			<th
				data-options="field:'matchGroupCode',width:20,align:'center',sortable:true">团队编号</th>
			<th
				data-options="field:'teacher.name',width:80,align:'center',sortable:true"
				formatter="formatterTeacher">指导老师</th>
			<th
				data-options="field:'classroom',width:20,align:'center',sortable:true">班级</th>
			<th
				data-options="field:'prize',width:30,align:'center',sortable:true">获奖等级</th>
			<th data-options="field:'isLocked',align:'center',width:20"
				formatter="formatterStatus">验证类型</th>
		</tr>
	</thead>
</table>
<div id="dg_groupMemberList_tb" style="padding:6px 10px;">
	队员/队长姓名: <input class="easyui-textbox" id="groupMemberList_memeberName"
		style="width:110px"> <a
		href="#" class="easyui-linkbutton" iconCls="icon-search"
		onclick="groupMemberListsearch()">Search</a>
</div>
